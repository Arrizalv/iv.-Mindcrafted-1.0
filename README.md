# üß† Mindcrafted - Future Learning Platform
<div align="center">
    
[![Vue 3](https://img.shields.io/badge/Vue.js-3.0-4FC08D?style=for-the-badge&logo=vue.js)](https://vuejs.org/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind-CSS-38B2AC?style=for-the-badge&logo=tailwind-css)](https://tailwindcss.com/)
[![Supabase](https://img.shields.io/badge/Supabase-Database-3ECF8E?style=for-the-badge&logo=supabase)](https://supabase.com/)
[![TypeScript](https://img.shields.io/badge/TypeScript-4.0-3178C6?style=for-the-badge&logo=typescript)](https://www.typescriptlang.org/)

**E-Learning ‚Ä¢ Marketplace ‚Ä¢ Mentoring ‚Ä¢ Community**

</div>

---

## üìñ Tentang Project

**Mindcrafted** adalah platform edukasi revolusioner yang menggabungkan fitur Learning Management System (LMS), Marketplace Freelance, dan Komunitas dalam satu ekosistem.

Project ini dibangun dengan fokus pada **Sistem Role-Based Access Control (RBAC)** yang canggih, memungkinkan satu pengguna memiliki banyak peran sekaligus (misal: Student di pagi hari, Mentor di malam hari).

## ‚ú® Fitur Unggulan

### üîê Keamanan & Autentikasi
* **Multi-Role System:** Support role `Student`, `Instructor`, `Mentor`, `Admin`.
* **Navigation Guards:** Proteksi rute frontend (Student tidak bisa akses halaman Admin).
* **Row Level Security (RLS):** Proteksi level database (User A tidak bisa mengintip data User B).

### üë• User Experience
* **Dashboard Adaptif:** Tampilan dashboard berubah sesuai role user.
* **Apply to Teach:** Flow pendaftaran otomatis bagi user yang ingin menjadi Instructor/Mentor.
* **Admin Control Center:** Panel khusus Admin untuk memantau user dan menyetujui lamaran instructor.

---

## ‚öôÔ∏è Langkah Awal Penggunaan

Untuk menjalankan proyek ini secara lokal, ikuti langkah-langkah berikut.

### 1. Prasyarat

- [Node.js](https://nodejs.org/) (Versi 18.x atau lebih tinggi direkomendasikan)
- `npm` (biasanya terinstal bersama Node.js)

### 2. Instalasi & Setup

1.  **Clone repository ini:**
    ```sh
    git clone https://github.com/nama-repo-anda/mindcrafted.git
    cd mindcrafted
    ```

2.  **Instal dependensi proyek:**
    ```sh
    npm install
    ```

3.  **Setup Environment Variables:**
    - Buka file `./routes/index.ts` 
    - Dapatkan **Project URL** dan **anon Key** dari dashboard Supabase Anda (Settings > API).
    - Ganti placeholder di dalam file `./routes/index.ts` dengan kredensial Supabase Anda.
      ```env
      # Supabase Credentials
      # Dapatkan dari dashboard proyek Supabase Anda
      VITE_SUPABASE_URL="https://your-supabase-url.supabase.co"
      VITE_SUPABASE_KEY="your-supabase-anon-key"
      ```

### 3. Menjalankan Aplikasi

- Setelah instalasi dan setup environment selesai, jalankan development server:
  ```sh
  npm run dev
  ```
- Aplikasi akan berjalan dan dapat diakses di `http://localhost:5173` (atau port lain yang ditampilkan di terminal).

---

### 4. Setup Database (PENTING ‚ö†Ô∏è)

Ini adalah **jantung** dari aplikasi ini. Copy-paste script SQL di bawah ini ke **SQL Editor** di Dashboard Supabase kamu untuk membuat tabel, relasi, dan sistem keamanan.

<details>
<summary>üëâ <strong>KLIK DISINI UNTUK LIHAT SCRIPT SQL LENGKAP</strong></summary>

```sql
-- 1. BUAT TABEL DASAR
create table public.roles (
  id bigint generated by default as identity primary key,
  name text not null unique
);

create table public.user_roles (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users(id) on delete cascade not null,
  role_id bigint references public.roles(id) on delete cascade not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  unique(user_id, role_id)
);

create table public.role_applications (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users(id) on delete cascade not null,
  requested_role text not null check (requested_role in ('instructor', 'mentor')),
  portfolio_url text,
  bio text,
  status text default 'pending' check (status in ('pending', 'approved', 'rejected')),
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 2. ISI DATA ROLE BAWAAN
insert into public.roles (name) values 
('admin'), ('student'), ('instructor'), ('mentor'), ('freelancer');

-- 3. BUAT FUNGSI 'SAKTI' ADMIN (ANTI INFINITE LOOP)
-- Fungsi ini bypass RLS biar database gak crash saat ngecek admin
CREATE OR REPLACE FUNCTION public.check_is_admin() 
RETURNS boolean AS $$
BEGIN
  RETURN EXISTS (
    SELECT 1 FROM public.user_roles ur
    JOIN public.roles r ON ur.role_id = r.id
    WHERE ur.user_id = auth.uid() AND r.name = 'admin'
  );
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- 4. AKTIFKAN RLS & POLICY (SATPAAM DATABASE)

-- Tabel Profiles
ALTER TABLE public.profiles ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Public profiles are viewable by everyone" ON public.profiles FOR SELECT USING (true);

-- Tabel User Roles
ALTER TABLE public.user_roles ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Users can see own roles" ON public.user_roles FOR SELECT USING (auth.uid() = user_id);
CREATE POLICY "Admins can manage all user roles" ON public.user_roles FOR ALL 
USING (public.check_is_admin()) WITH CHECK (public.check_is_admin());

-- Tabel Role Applications
ALTER TABLE public.role_applications ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Users can manage own application" ON public.role_applications FOR ALL USING (auth.uid() = user_id);
CREATE POLICY "Admins can manage applications" ON public.role_applications FOR ALL USING (public.check_is_admin());

-- 5. TAMBAHKAN FOREIGN KEYS (BIAR JOIN GAK ERROR)
ALTER TABLE public.user_roles
ADD CONSTRAINT fk_user_roles_profiles
FOREIGN KEY (user_id) REFERENCES public.profiles (id) ON DELETE CASCADE;

ALTER TABLE public.role_applications
ADD CONSTRAINT fk_user_profile
FOREIGN KEY (user_id) REFERENCES public.profiles (id) ON DELETE CASCADE;

-- 6. TRIGGER AUTO-ASSIGN STUDENT
CREATE OR REPLACE FUNCTION public.handle_new_user_role() 
RETURNS trigger AS $$
DECLARE
  student_role_id int;
BEGIN
  SELECT id INTO student_role_id FROM public.roles WHERE name = 'student';
  INSERT INTO public.user_roles (user_id, role_id) VALUES (new.id, student_role_id);
  RETURN new;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER on_auth_user_created_role
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE PROCEDURE public.handle_new_user_role();

```

</details>

---

### 5. Jalankan Aplikasi

```bash
npm run dev

```

---

## üìÇ Struktur Proyek

Berikut adalah gambaran umum tentang bagaimana kode diatur:

```
src/
‚îú‚îÄ‚îÄ assets/         # Aset statis seperti gambar dan SVG
‚îú‚îÄ‚îÄ components/     # Komponen Vue yang dapat digunakan kembali
‚îú‚îÄ‚îÄ composables/    # Fungsi Composition API untuk state management (cth: useUser)
‚îú‚îÄ‚îÄ lib/            # Inisialisasi klien eksternal (cth: supabase.ts)
‚îú‚îÄ‚îÄ router/         # Konfigurasi routing aplikasi (index.ts)
‚îú‚îÄ‚îÄ types/          # Definisi tipe TypeScript
‚îú‚îÄ‚îÄ views/          # Komponen halaman (satu untuk setiap rute)
‚îú‚îÄ‚îÄ App.vue         # Komponen root aplikasi
‚îú‚îÄ‚îÄ main.ts         # Titik masuk utama aplikasi
‚îî‚îÄ‚îÄ style.css       # File style global
```

---

## üõ†Ô∏è Cara Kerja Sistem (Deep Dive)

Bagian ini menjelaskan bagaimana logika kode bekerja untuk pemula yang ingin belajar dari repo ini.

### 1. Navigation Guard (Frontend Security)

File: `src/router/index.ts`
Bayangkan router ini sebagai **"Resepsionis Hotel"**.

* Setiap kali kamu mau pindah halaman, resepsionis akan mengecek: *"Apakah kamu punya tiket (Login)?"* dan *"Apakah tiketmu valid untuk masuk ke ruang VIP (Admin)?"*.
* Kode `to.meta.allowedRoles.some(...)` adalah logika pengecekannya.

### 2. Composable (Logic Reusability)

File: `src/composables/useUser.ts`
Daripada menulis kode fetch user di setiap halaman, kita membungkusnya dalam satu fungsi `useUser()`.

* Ini membuat kode lebih bersih.
* Memudahkan kita mengecek role user di mana saja dengan fungsi `hasRole('admin')`.

### 3. Row Level Security (Backend Security)

File: *Database Supabase*
Ini adalah pertahanan terakhir. Meskipun frontend berhasil di-hack, database tetap aman.

* **Masalah Infinite Loop:** Kita menggunakan teknik `SECURITY DEFINER` pada fungsi SQL `check_is_admin()`. Ini memberikan "hak akses khusus" pada fungsi tersebut supaya database tidak bingung (looping) saat mengecek apakah seseorang adalah admin.

---

## üëë Cara Menjadi Admin Pertama

Karena sistem ini aman, kamu tidak bisa sembarangan jadi Admin. Gunakan script SQL ini untuk mengangkat dirimu sendiri:

```sql
DO $$
DECLARE
  target_email text := 'email_kamu@gmail.com'; -- Ganti emailmu
  target_user_id uuid;
  admin_role_id int;
BEGIN
  SELECT id INTO target_user_id FROM auth.users WHERE email = target_email;
  SELECT id INTO admin_role_id FROM public.roles WHERE name = 'admin';
  
  -- Hapus role lama & masukkan role admin
  DELETE FROM public.user_roles WHERE user_id = target_user_id;
  INSERT INTO public.user_roles (user_id, role_id) VALUES (target_user_id, admin_role_id);
END $$;

```

---

## üêõ Troubleshooting Umum

**Q: Saya dapat Error 500 di Console?**
A: Itu biasanya karena "Infinite Loop" di Database Policy. Pastikan kamu sudah menjalankan script SQL `check_is_admin` di bagian setup database.

**Q: List User/Application kosong padahal ada datanya?**
A: Itu masalah RLS (Row Level Security). Pastikan kamu sudah menjalankan script SQL yang memberi akses `SELECT` pada tabel `profiles` untuk publik.

**Q: Error "Could not find relationship"?**
A: Database bingung cara menghubungkan tabel. Pastikan kamu sudah menjalankan perintah `ADD CONSTRAINT FOREIGN KEY` di script SQL setup.

---

<p align="center">Made with ‚ù§Ô∏è by <b>Mindcrafted Team</b></p>

```

```

---

## üìö Materi Pembelajaran

Bagi Anda yang baru mengenal teknologi yang kami gunakan, berikut adalah beberapa sumber daya untuk memulai:

- **Vue.js:** [Dokumentasi Resmi Vue 3](https://vuejs.org/guide/introduction.html) - Tempat terbaik untuk mempelajari dasar-dasar Vue.
- **Vite:** [Dokumentasi Resmi Vite](https://vitejs.dev/guide/) - Pelajari mengapa build tool ini sangat cepat.
- **Supabase:** [Dokumentasi Supabase](https://supabase.com/docs) - Pahami cara kerja "The Open Source Firebase Alternative".
- **Tailwind CSS:** [Dokumentasi Resmi Tailwind CSS](https://tailwindcss.com/docs/installation) - Pelajari cara menggunakan utility-first CSS framework.
- **TypeScript:** [TypeScript for New Programmers](https://www.typescriptlang.org/docs/handbook/typescript-from-scratch.html) - Pengenalan dasar TypeScript.

---

<div align="center">
Selamat belajar dan berkarya! üöÄ
</div>
